--- REL_17_5_WASM/src/interfaces/libpq/fe-auth.c
+++ REL_17_5_WASM-pglite/src/interfaces/libpq/fe-auth.c
@@ -1169,6 +1169,7 @@
 pg_fe_getusername(uid_t user_id, PQExpBuffer errorMessage)
 {
 	char	   *result = NULL;
+#if !defined(__EMSCRIPTEN__) && !defined(__wasi__)
 	const char *name = NULL;
 
 #ifdef WIN32
@@ -1192,7 +1193,9 @@
 	else if (errorMessage)
 		appendPQExpBuffer(errorMessage, "%s\n", pwdbuf);
 #endif
-
+#else
+	const char *name = getenv("PGUSER");
+#endif
 	if (name)
 	{
 		result = strdup(name);
